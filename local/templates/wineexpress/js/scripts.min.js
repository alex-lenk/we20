"use strict";function documentMouseup(e,t){$(document).mouseup((function(a){$(e).is(a.target)||0!==$(e).has(a.target).length||$(e).removeClass(t)}))}function ValidMail(){let e,t=document.getElementById("subscription-field").value,a=/^[\w-\.]+@[\w-]+\.[a-z]{2,4}$/i.test(t);return e=a?'<div class="footer-subscription__error">отправляем</div>':'<div class="footer-subscription__error">E-mail не верен!</div>',document.querySelector(".subscribe-form-item").insertAdjacentHTML("afterbegin",e),a}function onClickVolag(e){addcartpopup();let t=e.dataset.id,a=1;return e.hasAttribute("data-q")&&(a=+e.dataset.q),$.ajax({type:"POST",url:"/ajax/cart/addcart.php",data:"ID="+t+"&Q="+a,success:function(){ReloadCartCount()}}),!1}function GetCartCount(){let e;return $.ajax({type:"POST",url:"/ajax/cart/count.php",async:!1,data:"",success:function(t){e=t}}),e}function ReloadCartCount(){$(".header-basket__element").attr("data-basket-amount",GetCartCount())}function addcartpopup(){$.when(ShowCartPop()).done((function(){HideCartPop()}))}function ShowCartPop(){$(".popalert").animate({top:"+=140px",opacity:"1"},"1000").delay(1e3)}function HideCartPop(){$(".popalert").animate({top:"-=140px",opacity:"0"},"1000")}function onClickUserConsert(e){e.value="Y"===e.value?"N":"Y",btnsOrderConfirm=document.querySelectorAll("a.btn-order-save"),btnsOrderConfirm.forEach((function(t,a,n){"Y"===e.value?t.classList.remove("disabled"):t.classList.add("disabled")}))}function number_format(e,t,a,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");let l=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):0,s=void 0===n?",":n,r=void 0===a?".":a,c="";return c=(o?function(e,t){let a=Math.pow(10,t);return""+Math.round(e*a)/a}(l,o):""+Math.round(l)).split("."),c[0].length>3&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(c[1]||"").length<o&&(c[1]=c[1]||"",c[1]+=new Array(o-c[1].length+1).join("0")),c.join(r)}$(document).ready((function(){$(".slick-init").slick();let e=$(".top-panel-info__text");e.click((function(){$(this).hasClass("top-panel-info__active")?$(this).removeClass("top-panel-info__active"):($(".top-panel-info__text.top-panel-info__active").removeClass("top-panel-info__active"),$(this).addClass("top-panel-info__active"))})),documentMouseup(e,"top-panel-info__active");if($(window).width()<1100&&$(".header-address__label").click((function(){$(this).hasClass("header-address__active")?$(this).removeClass("header-address__active"):($(".header-address__label.header-address__active").removeClass("header-address__active"),$(this).addClass("header-address__active"))})),$(window).width()>1099){let e=$(".scroll-to-top");$(window).scroll((function(){$(this).scrollTop()>450?e.fadeIn():e.fadeOut()})),e.click((function(){return $("body,html").animate({scrollTop:0},400),!1}))}let t=".call-form-dialog .call-form";$(".top-panel-js, .call-form .close").click((function(){$(".call-form-dialog").toggleClass("call-form-opened")})),$(document).mouseup((function(e){$(t).is(e.target)||0!==$(t).has(e.target).length||$(".call-form-dialog").removeClass("call-form-opened")}));let a=$(".header-search"),n=$(".header-search__inner"),l=$(".header-search__field"),o=$(".header-search__close");if(o.click((function(){n.removeClass("header-search__active"),n.removeClass("header-search__active-clear"),l.val("")})),$(".header-search__clear").click((function(){l.val("").focus(),n.removeClass("header-search__active-clear")})),l.keyup((function(){$(this).val().length>=2?(n.addClass("header-search__active"),n.addClass("header-search__active-clear")):(n.removeClass("header-search__active"),n.removeClass("header-search__active-clear"))})),$(".header-search__view").click((function(){a.slideDown(),$(".header-search__field").focus(),$("body").addClass("header-search__opened")})),$(window).width()<1099&&(o.click((function(){a.slideUp(),$("body").removeClass("header-search__opened")})),$(document).mouseup((function(e){a.is(e.target)||0!==a.has(e.target).length||(a.slideUp(),$("body").removeClass("header-search__opened"))}))),$(".menu-toggle").click((function(){$("html").toggleClass("menu-opened"),$(".menu-nav__inner").toggleClass("menu-nav__inner-open")})),$(".nav-bar-close, .nav-bar-content__close").click((function(){$("html").removeClass("menu-opened"),r.removeClass(u),c.removeClass(p),i.text("")})),$(window).width()>1199){let e=".header-inner";$(window).scroll((function(){$(this).scrollTop()>450?($(e).addClass("nav-scroll"),$(".menu-nav__inner").addClass("nav-scroll__menu"),$(".header-logo__wrap").removeClass("col-lg-3 col-4").addClass("col-xl-1 col-lg-2"),$(".header-search").addClass("offset-xl-1"),$(".header-call").removeClass("col-2")):($(e).removeClass("nav-scroll"),$(".menu-nav__inner").removeClass("nav-scroll__menu"),$(".header-logo__wrap").addClass("col-lg-3 col-4").removeClass("col-xl-1 col-lg-2"),$(".header-search").removeClass("offset-xl-1"),$(".header-call").addClass("col-2"))}))}let s=$(".sticker-rating");s.click((function(){$(this).hasClass("sticker-rating__opened")?$(this).removeClass("sticker-rating__opened"):($(".sticker-rating.sticker-rating__opened").removeClass("sticker-rating__opened"),$(this).addClass("sticker-rating__opened"))})),documentMouseup(s,"sticker-rating__opened");let r=$(".nav-bar"),c=$(".nav-bar-point__parent"),i=$(".nav-bar-panel__title"),d=$(".nav-bar-panel__back"),u="nav-bar-panel__opened",p="nav-bar-layer__opened";c.click((function(){r.addClass(u),$(this).addClass(p);let e=$(this).find(".nav-bar-point__text").text();i.text(e)})),d.click((function(){r.removeClass(u),c.removeClass(p),i.text("")})),$(".volag-elementcard-plus").click((function(){let e=$(this).prev(".volag-elementcard-count"),t=$(this).closest(".volag-elementcard-panel").find(".volag-elementcard-totalsum"),a=$(this).closest(".volag-elementcard-panel").find(".volag-elementcard-newsum"),n=parseInt(a.text().replace(/\s/g,""));e.val(parseInt(e.val())+1);let l=parseInt(e.val());t.text(number_format(n*l,0,","," ")+" ₽"),$(this).closest(".volag-elementcard-panel").find("button.volag-button-addtocart").attr("data-q",l)})),$(".volag-elementcard-minus").click((function(){let e=$(this).next(".volag-elementcard-count"),t=$(this).closest(".volag-elementcard-panel").find(".volag-elementcard-totalsum"),a=$(this).closest(".volag-elementcard-panel").find(".volag-elementcard-newsum"),n=parseInt(a.text().replace(/\s/g,""));if(e.val()>1){e.val(parseInt(e.val())-1);let a=parseInt(e.val());t.text(number_format(n*a,0,","," ")+" ₽"),$(this).closest(".volag-elementcard-panel").find("button.volag-button-addtocart").attr("data-q",a)}else $(this).closest(".volag-elementcard-panel").find("button.volag-button-addtocart").attr("data-q","1")})),$(l).length>0&&($(l).autocomplete({source:function(e,t){$(".ui-autocomplete").show().html("<ul class='preUpLoader'><li><a style='text-decoration:none; color:gray'>Идёт поиск...</a></li></ul>"),null==document.querySelector(".preUpLoader")?$("<ul class='preUpLoader'><li><a style='text-decoration:none; color:gray'>Идёт поиск...</a></li></ul>").insertAfter($(".form__search-input")):$(".preUpLoader").show(),$.ajax({url:"/ajax/search/autocomplete.php",dataType:"json",data:{term:e.term},success:function(e){t(e)}},"json")},minLength:2,focus:function(e,t){e.preventDefault()},select:function(e,t){return!!t.item&&($(t.item.value).hasClass("do_not_show")||$(l).val($(t.item.value).find(".item_name").text()),!1)},appendTo:".header__search"}).data("ui-autocomplete")._renderItem=function(e,t){return $(".preUpLoader").hide(),$(t.value).data("item.ui-autocomplete",t).appendTo(e)}),$(".main-slider").slick({slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:5e3,dots:!0,fade:!0,responsive:[{breakpoint:575,settings:{dots:!1}}]})})),document.documentElement.clientWidth>576&&$(document).ready((function(){$(".winery-nav__list").slick({slidesToShow:5,slidesToScroll:1,variableWidth:!0,arrows:!0,dots:!1,responsive:[{breakpoint:1100,settings:{slidesToShow:4}},{breakpoint:600,settings:{slidesToShow:2}}]})})),window.addEventListener("load",(function(){baguetteBox.run(".winery-slider")})),$(document).ready((function(){setTimeout((function(){ReloadCartCount()}),4e3)})),$(".modal-year__close").click((function(){$.ajax({type:"POST",url:"/ajax/setyear.php",data:"YEAR=Y",success:function(e){}}),$("body").removeClass("modal-year__open"),$(".modal-year__wrap").fadeOut()}));let tabLinks=document.querySelectorAll(".tab-links"),tabContent=document.querySelectorAll(".tab-pane");function openTabs(e){let t=e.currentTarget,a=t.dataset.tab;Array.prototype.forEach.call(tabContent,(function(e){e.classList.remove("active")})),Array.prototype.forEach.call(tabLinks,(function(e){e.classList.remove("active")})),document.querySelector("#"+a).classList.add("active"),t.classList.add("active")}Array.prototype.forEach.call(tabLinks,(function(e){e.addEventListener("click",openTabs)}));let i,acc=document.getElementsByClassName("js__accordion");for(i=0;i<acc.length;i++)acc[i].addEventListener("click",(function(){this.classList.toggle("collapsed");let e=this.nextElementSibling;e.style.maxHeight?e.style.maxHeight=null:e.style.maxHeight=e.scrollHeight+"px"}));window.addEventListener("DOMContentLoaded",(function(){let e=document.querySelectorAll('#soa-property-2, input[name="form_text_2"]');Array.prototype.forEach.call(e,(function(e){let t;function a(e){e.keyCode&&(t=e.keyCode),this.selectionStart<3&&e.preventDefault();let a="+7 (___) ___ ____",n=0,l=a.replace(/\D/g,""),o=this.value.replace(/\D/g,""),s=a.replace(/[_\d]/g,(function(e){return n<o.length?o.charAt(n++)||l.charAt(n):e}));n=s.indexOf("_"),-1!==n&&(n<5&&(n=3),s=s.slice(0,n));let r=a.substr(0,this.value.length).replace(/_+/g,(function(e){return"\\d{1,"+e.length+"}"})).replace(/[+()]/g,"\\$&");r=new RegExp("^"+r+"$"),(!r.test(this.value)||this.value.length<5||t>47&&t<58)&&(this.value=s),"blur"===e.type&&this.value.length<5&&(this.value="")}e.addEventListener("input",a,!1),e.addEventListener("focus",a,!1),e.addEventListener("blur",a,!1),e.addEventListener("keydown",a,!1)}))}));